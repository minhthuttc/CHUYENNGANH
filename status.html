<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tráº¡ng ThÃ¡i Há»‡ Thá»‘ng - DesignHub</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .status-card {
            margin: 1rem 0;
            padding: 1.5rem;
            border-radius: 8px;
            border: 2px solid #ddd;
        }
        .status-ok {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .status-error {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .status-warning {
            background: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }
        .link-box {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 5px;
            margin: 0.5rem 0;
        }
        .link-box a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
        }
        .link-box a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="index.html" class="logo">ğŸ¨ DesignHub</a>
            <div class="nav-links">
                <a href="check-server.html">Kiá»ƒm Tra Server</a>
                <a href="status.html" class="active">Tráº¡ng ThÃ¡i</a>
            </div>
        </nav>
    </header>

    <main class="container">
        <h1>ğŸ“Š Tráº¡ng ThÃ¡i Há»‡ Thá»‘ng</h1>

        <div id="serverStatus" class="status-card">
            <h2>â³ Äang kiá»ƒm tra...</h2>
        </div>

        <div class="card">
            <h2>ğŸŒ CÃ¡c Trang CÃ³ Thá»ƒ Sá»­ Dá»¥ng</h2>
            
            <h3>ğŸ” Kiá»ƒm Tra & Test</h3>
            <div class="link-box">
                <a href="check-server.html" target="_blank">
                    ğŸ”„ Kiá»ƒm Tra Server
                </a>
                <p>Kiá»ƒm tra server cÃ³ Ä‘ang cháº¡y khÃ´ng</p>
            </div>
            <div class="link-box">
                <a href="test-register.html" target="_blank">
                    ğŸ§ª Test ÄÄƒng KÃ½
                </a>
                <p>Test API Ä‘Äƒng kÃ½ vá»›i dá»¯ liá»‡u máº«u</p>
            </div>

            <h3>ğŸ‘¤ NgÆ°á»i DÃ¹ng</h3>
            <div class="link-box">
                <a href="register.html" target="_blank">
                    ğŸ“ ÄÄƒng KÃ½
                </a>
                <p>ÄÄƒng kÃ½ tÃ i khoáº£n má»›i (Client/Designer)</p>
            </div>
            <div class="link-box">
                <a href="login.html" target="_blank">
                    ğŸ”‘ ÄÄƒng Nháº­p
                </a>
                <p>ÄÄƒng nháº­p vÃ o há»‡ thá»‘ng</p>
            </div>

            <h3>ğŸ‘¨â€ğŸ’¼ Admin</h3>
            <div class="link-box">
                <a href="admin-register.html" target="_blank">
                    ğŸ” ÄÄƒng KÃ½ Admin
                </a>
                <p>ÄÄƒng kÃ½ tÃ i khoáº£n admin (cáº§n mÃ£ báº£o máº­t)</p>
            </div>
            <div class="link-box">
                <a href="admin.html" target="_blank">
                    âš™ï¸ Quáº£n Trá»‹
                </a>
                <p>Trang quáº£n trá»‹ há»‡ thá»‘ng</p>
            </div>

            <h3>ğŸ“š HÆ°á»›ng Dáº«n</h3>
            <div class="link-box">
                <a href="START_HERE.md" target="_blank">
                    ğŸš€ Báº¯t Äáº§u Sá»­ Dá»¥ng
                </a>
                <p>HÆ°á»›ng dáº«n tá»•ng quan</p>
            </div>
            <div class="link-box">
                <a href="HUONG_DAN_SU_DUNG_SERVER.md" target="_blank">
                    ğŸ“– HÆ°á»›ng Dáº«n Server
                </a>
                <p>Chi tiáº¿t vá» 2 loáº¡i server</p>
            </div>
            <div class="link-box">
                <a href="SUA_LOI_MONGODB.md" target="_blank">
                    ğŸ”§ Sá»­a Lá»—i MongoDB
                </a>
                <p>HÆ°á»›ng dáº«n sá»­a lá»—i káº¿t ná»‘i MongoDB</p>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ› ï¸ ThÃ´ng Tin Ká»¹ Thuáº­t</h2>
            <div style="background: #f5f5f5; padding: 1rem; border-radius: 5px; font-family: monospace;">
                <p><strong>API URL:</strong> http://localhost:3000/api</p>
                <p><strong>Server Type:</strong> <span id="serverType">Äang kiá»ƒm tra...</span></p>
                <p><strong>Database:</strong> <span id="dbStatus">Äang kiá»ƒm tra...</span></p>
            </div>
        </div>

        <div class="card" style="background: var(--light-brown);">
            <h2>ğŸ’¡ LÆ°u Ã</h2>
            <ul style="line-height: 2;">
                <li><strong>Mock Server:</strong> Dá»¯ liá»‡u lÆ°u trong RAM, máº¥t khi restart</li>
                <li><strong>Server ChÃ­nh:</strong> Cáº§n MongoDB Atlas, lÆ°u dá»¯ liá»‡u vÄ©nh viá»…n</li>
                <li><strong>MÃ£ Admin:</strong> DESIGNHUB_ADMIN_110122174</li>
                <li><strong>Test API:</strong> Cháº¡y <code>node test-api-full.js</code> trong terminal</li>
            </ul>
        </div>
    </main>

    <script>
        const API_URL = 'http://localhost:3000/api';

        async function checkStatus() {
            const statusDiv = document.getElementById('serverStatus');
            const serverTypeSpan = document.getElementById('serverType');
            const dbStatusSpan = document.getElementById('dbStatus');

            try {
                const response = await fetch(`${API_URL}/test`);
                const data = await response.json();

                if (response.ok) {
                    statusDiv.className = 'status-card status-ok';
                    statusDiv.innerHTML = `
                        <h2>âœ… Server Äang Hoáº¡t Äá»™ng</h2>
                        <p><strong>Status:</strong> ${data.status}</p>
                        <p><strong>Message:</strong> ${data.message}</p>
                        <p><strong>URL:</strong> ${API_URL}</p>
                    `;

                    // Detect server type
                    const testRegister = await fetch(`${API_URL}/auth/register`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            fullName: 'Test',
                            email: 'test_probe_' + Date.now() + '@test.com',
                            password: '123456',
                            userType: 'client'
                        })
                    });

                    if (testRegister.ok) {
                        serverTypeSpan.textContent = 'Mock Server (KhÃ´ng cáº§n MongoDB)';
                        serverTypeSpan.style.color = '#28a745';
                        dbStatusSpan.textContent = 'RAM (Dá»¯ liá»‡u táº¡m thá»i)';
                        dbStatusSpan.style.color = '#ffc107';
                    } else {
                        const errorData = await testRegister.json();
                        if (errorData.message && errorData.message.includes('MongoDB')) {
                            serverTypeSpan.textContent = 'Server ChÃ­nh (Lá»—i MongoDB)';
                            serverTypeSpan.style.color = '#dc3545';
                            dbStatusSpan.textContent = 'MongoDB Atlas (ChÆ°a káº¿t ná»‘i)';
                            dbStatusSpan.style.color = '#dc3545';
                        }
                    }
                } else {
                    throw new Error('Server khÃ´ng pháº£n há»“i');
                }
            } catch (error) {
                statusDiv.className = 'status-card status-error';
                statusDiv.innerHTML = `
                    <h2>âŒ Server KhÃ´ng Hoáº¡t Äá»™ng</h2>
                    <p><strong>Lá»—i:</strong> ${error.message}</p>
                    <p><strong>Giáº£i phÃ¡p:</strong></p>
                    <ol>
                        <li>Má»Ÿ terminal</li>
                        <li>Cháº¡y: <code>node server-mock.js</code></li>
                        <li>Hoáº·c: Double click <code>start-mock-server.bat</code></li>
                        <li>Refresh trang nÃ y</li>
                    </ol>
                `;
                serverTypeSpan.textContent = 'KhÃ´ng hoáº¡t Ä‘á»™ng';
                serverTypeSpan.style.color = '#dc3545';
                dbStatusSpan.textContent = 'KhÃ´ng hoáº¡t Ä‘á»™ng';
                dbStatusSpan.style.color = '#dc3545';
            }
        }

        // Auto check on load
        window.addEventListener('load', checkStatus);

        // Refresh every 10 seconds
        setInterval(checkStatus, 10000);
    </script>
</body>
</html>
